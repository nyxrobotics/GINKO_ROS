<!-- -*- mode: XML -*- -->
<launch>

	<!-- urdf xml robot description loaded on the Parameter Server, converting the xacro into a proper urdf file-->
	<param name="robot_description" command="$(find xacro)/xacro '$(find ginko_description)/models/ginko_auto/urdf/robot.urdf.xacro'" />
	<!-- Publish Default tf2 of imu callibrated -->
	<arg name="imu_calibrated_tf"   default="imu_calib_link"/>
	<node name="imu_tf2_ofs" pkg="tf2_ros" type="static_transform_publisher" args="0.2 0 0 0 0 0 1 body_imu_attached_link $(arg imu_calibrated_tf)" />



	<group ns="servo_motor">
	    <!-- servo controller -->
		<include file="$(find ginko_joint_controller)/launch/ginko_joint_controller.launch" >
			<!-- <rosparam file="$(find ginko_joint_controller)/cfg/servo_offsets.yaml" command="load"/> -->
			<!-- <remap from="joint_states" to="/servo_motor/joint_states" /> -->
		</include>
		<!-- <rosparam file="$(find ginko_joint_controller)/cfg/servo_offsets.yaml" command="load"/> -->
	
		<node name="robot_state_publisher" pkg="robot_state_publisher" type="state_publisher" >
			<param name="publish_frequency" value="100"/>
<!-- 			<param name="ignore_timestamp" value="true"/> -->
	    	<!-- use_tf_staticがtrueだとめっちゃ遅くなる。60Hzくらいしか出ない。 -->
			<param name="use_tf_static" value="false"/>
		</node>
	</group>

	<group ns="sensor">
	

		
		<!-- LiDAR (HOKUYO) -->
		<group ns="urg">
			<!-- Right LiDAR -->
			<group ns="right">
				<!-- Connect under USB-Serial -->
			    <node name="urg_right_node" pkg="urg_node" type="urg_node">
    				<!-- Topic name: /sensor/urg/right/scan -->
					<remap from="scan" to="scan" />
					<param name="serial_port" value="/dev/ttyURG_1.4" />
					<param name="frame_id" value="arm_r_urg_link" />
					<param name="time_calib" value="-0.07" />
					<param name="ofs_const_calib" value="0.0" />
					<param name="ofs_linear_calib" value="0.0" />
<!-- 					<param name="ofs_const_calib" value="0.02" /> -->
<!-- 					<param name="ofs_linear_calib" value="0.0" /> -->
					<!-- <param name="angle_min" value="-2.2" /> -->
					<!-- <param name="angle_max" value="2.2" /> -->
				</node>
			</group>
			
			<!-- Left LiDAR -->
			<group ns="left">
				<!-- Connect under USB-Serial -->
			    <node name="urg_left_node" pkg="urg_node" type="urg_node">
       				<!-- Topic name: /sensor/urg/left/scan -->
					<remap from="scan" to="scan" />
					<param name="serial_port" value="/dev/ttyURG_1.1" />
					<param name="frame_id" value="arm_l_urg_link" />
					<param name="time_calib" value="-0.07" />
					<param name="ofs_const_calib" value="0.03" />
					<param name="ofs_linear_calib" value="0.05" />
<!-- 					<param name="ofs_const_calib" value="0.08" /> -->
<!-- 					<param name="ofs_linear_calib" value="0.01" /> -->
			     	<!-- <param name="angle_min" value="-2.2" /> -->
			        <!-- <param name="angle_max" value="2.2" /> -->
				</node>
			</group>
		</group>
		
	</group>
	
	<!-- laser assembler(move lidar -> create pointcloud) -->
<!-- 	<group ns="laser_assembler"> -->
<!-- 		<group ns="right"> -->
<!-- 			<node name="urg_right_assembler" pkg="laser_assembler" type="laser_scan_assembler"> -->
<!-- 				<remap from="scan" to="/sensor/urg/right/scan"/> -->
<!-- 				<param name="max_scans" type="int" value="400" /> -->
<!-- 				<param name="fixed_frame" type="string" value="body_imu_reverse" /> -->
<!-- 			</node> -->
<!-- 			<node name="urg_right_assembler_client" pkg="laser_assembler_client" type="laser_assembler_client"> -->
<!-- 				<remap from="cloud" to="right_cloud"/> -->
<!-- 			</node> -->
<!-- 		</group> -->
<!-- 		<group ns="left"> -->
<!-- 			<node name="urg_left_assembler" pkg="laser_assembler" type="laser_scan_assembler"> -->
<!-- 				<remap from="scan" to="/sensor/urg/left/scan"/> -->
<!-- 				<param name="max_scans" type="int" value="400" /> -->
<!-- 				<param name="fixed_frame" type="string" value="body_imu_reverse" /> -->
<!-- 			</node> -->
<!-- 			<node name="urg_left_assembler_client" pkg="laser_assembler_client" type="laser_assembler_client"> -->
<!-- 				<remap from="cloud" to="left_cloud"/> -->
<!-- 			</node> -->
<!-- 		</group> -->
<!-- 	</group> -->
	
	<!-- voxelgrid -->
<!-- 	<arg name="nodelet_manager"   default="voxelgrid_nodelet"/> -->
<!-- 	<group ns="voxelgrid"> -->
<!-- 		<node name="$(arg nodelet_manager)" pkg="nodelet" type="nodelet" args="manager" output="screen" /> -->
<!-- 		<group ns="right"> -->
<!-- 			<node name="octree_voxel_grid" pkg="nodelet" type="nodelet" args="load jsk_pcl/OctreeVoxelGrid /voxelgrid/$(arg nodelet_manager)"> -->
<!-- 			    <remap from="~input" to="/laser_assembler/right/right_cloud"/> -->
<!-- 			    <remap from="~output" to="right_mark"/> -->
<!-- 				<param name="~resolution" value="0.02" /> -->
<!-- 				<param name="~publish_marker" value="false" /> -->
<!-- 			</node> -->
<!-- 		</group> -->
	
<!-- 		<group ns="left"> -->
<!-- 			<node name="octree_voxel_grid" pkg="nodelet" type="nodelet" args="load jsk_pcl/OctreeVoxelGrid /voxelgrid/$(arg nodelet_manager)"> -->
<!-- 			    <remap from="~input" to="/laser_assembler/left/left_cloud"/> -->
<!-- 			    <remap from="~output" to="left_mark"/> -->
<!-- 				<param name="~resolution" value="0.02" /> -->
<!-- 				<param name="~publish_marker" value="false" /> -->
<!-- 			</node> -->
<!-- 		</group> -->
<!-- 	</group> -->
</launch>
